<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>3D UA HUB</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { background-color: #f3f4f6; font-family: -apple-system, sans-serif; }
        .search-area { background: #18181b; padding: 20px; border-radius: 0 0 24px 24px; }
        .item-card { background: white; border-radius: 20px; padding: 16px; border: 1px solid transparent; position: relative; }
        .global-tag { position: absolute; top: 10px; left: 10px; background: #3b82f6; color: white; font-size: 8px; padding: 2px 6px; border-radius: 6px; font-weight: 800; }
        .modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); backdrop-filter: blur(5px); display: none; z-index: 1000; align-items: flex-end; }
        .modal.active { display: flex; }
        .modal-content { background: white; width: 100%; border-radius: 24px 24px 0 0; padding: 25px; }
    </style>
</head>
<body class="pb-32">

    <div class="search-area sticky top-0 z-50">
        <div class="flex items-center justify-between mb-4">
            <span class="text-[10px] font-black uppercase text-zinc-500">Global 3D Engine (UA Support)</span>
            <div id="loader" class="hidden text-yellow-500 text-[10px] font-bold animate-pulse">–ü–ï–†–ï–ö–õ–ê–î –¢–ê –ü–û–®–£–ö...</div>
        </div>
        <div class="flex gap-2">
            <input id="searchInput" type="text" placeholder="–©–æ –∑–Ω–∞–π—Ç–∏? (–Ω–∞–ø—Ä. –®–æ–ª–æ–º)" 
                class="w-full bg-zinc-800 border-none rounded-xl p-4 text-white outline-none focus:ring-2 focus:ring-blue-500 text-sm">
            <button onclick="startGlobalSearch()" class="bg-blue-600 text-white px-5 rounded-xl font-bold text-xs uppercase">GO</button>
        </div>
    </div>

    <div class="p-4">
        <div id="results-title" class="text-[10px] font-black text-zinc-400 uppercase mb-4 ml-2">–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó</div>
        <div id="grid" class="grid grid-cols-2 gap-4">
            </div>
    </div>

    <div id="itemModal" class="modal" onclick="closeModal()">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div id="modal-img" class="text-6xl text-center mb-4"></div>
            <h3 id="modal-name" class="text-xl font-black text-center uppercase tracking-tighter"></h3>
            <p class="text-zinc-500 text-center text-sm my-4">–¶—è –º–æ–¥–µ–ª—å –∑–Ω–∞–π–¥–µ–Ω–∞ –≤ –≥–ª–æ–±–∞–ª—å–Ω—ñ–π –±–∞–∑—ñ. –ú–∏ –º–æ–∂–µ–º–æ –Ω–∞–¥—Ä—É–∫—É–≤–∞—Ç–∏ —ó—ó —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–æ –¥–ª—è –≤–∞—Å.</p>
            <div id="modal-price" class="text-3xl font-black text-center text-blue-600 mb-6"></div>
            <button onclick="addToCartFromModal()" class="w-full bg-blue-600 text-white py-4 rounded-2xl font-black shadow-lg uppercase">–ó–∞–º–æ–≤–∏—Ç–∏ –¥—Ä—É–∫</button>
        </div>
    </div>

    <div id="footer" class="fixed bottom-0 left-0 right-0 p-6 bg-white/90 border-t hidden z-50">
        <button onclick="sendOrder()" class="w-full bg-black text-white py-4 rounded-2xl font-black flex justify-between px-8">
            <span>–û–§–û–†–ú–ò–¢–ò</span>
            <span id="total">0 ‚Ç¥</span>
        </button>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        let cart = [];
        let total = 0;
        let selectedItem = null;

        // –°–ª–æ–≤–Ω–∏–∫ –¥–ª—è –º–∏—Ç—Ç—î–≤–æ–≥–æ –ø–µ—Ä–µ–∫–ª–∞–¥—É (UA -> EN)
        const dictionary = {
            "—à–æ–ª–æ–º": "helmet", "–º–∞—Å–∫–∞": "mask", "–≤–∞–∑–∞": "vase", "–¥—Ä–∞–∫–æ–Ω": "dragon",
            "—Ç—Ä–∏–º–∞—á": "holder", "–ø—ñ–¥—Å—Ç–∞–≤–∫–∞": "stand", "–∫—ñ–ª—å—Ü–µ": "ring", "—ñ–≥—Ä–∞—à–∫–∞": "toy",
            "–ª—ñ—Ç–∞–∫": "plane", "–º–∞—à–∏–Ω–∞": "car", "—á–µ—Ä–µ–ø": "skull", "–∫–æ—Ä–æ–±–∫–∞": "box",
            "–¥–µ—Ç–∞–ª—å": "part", "–ª–∞–º–ø–∞": "lamp", "–≥–æ—Ä—â–∏–∫": "pot", "—Ñ—ñ–≥—É—Ä–∫–∞": "figure"
        };

        function startGlobalSearch() {
            const input = document.getElementById('searchInput').value.toLowerCase().trim();
            const loader = document.getElementById('loader');
            const grid = document.getElementById('grid');
            
            if (!input) return;

            loader.classList.remove('hidden');
            
            // 1. –ê–≤—Ç–æ–ø–µ—Ä–µ–∫–ª–∞–¥
            let searchQuery = dictionary[input] || input;
            
            // 2. –Ü–º—ñ—Ç–∞—Ü—ñ—è –∑–∞–ø–∏—Ç—É –¥–æ API (Thangs/Thingiverse)
            setTimeout(() => {
                const results = [
                    { name: "Global " + input + " #1", price: 800, icon: "üì¶", source: "Internet" },
                    { name: "Global " + input + " #2", price: 1200, icon: "üì¶", source: "Internet" },
                    { name: "Custom " + input, price: 500, icon: "‚öôÔ∏è", source: "AI Support" }
                ];

                grid.innerHTML = '';
                results.forEach((item, index) => {
                    grid.innerHTML += `
                        <div class="item-card shadow-sm animate-in fade-in" onclick='openModal(${JSON.stringify(item)})'>
                            <span class="global-tag">INTERNET</span>
                            <div class="text-5xl mb-3 text-center">${item.icon}</div>
                            <h3 class="text-[10px] font-black uppercase truncate">${item.name}</h3>
                            <p class="text-blue-600 font-bold text-sm mt-1">${item.price} ‚Ç¥</p>
                            <button class="bg-zinc-100 text-zinc-800 rounded-lg w-full py-2 mt-3 text-[10px] font-bold">–î–ï–¢–ê–õ–Ü</button>
                        </div>
                    `;
                });

                document.getElementById('results-title').innerText = `–ó–Ω–∞–π–¥–µ–Ω–æ –∑–∞ –∑–∞–ø–∏—Ç–æ–º: ${input}`;
                loader.classList.add('hidden');
                tg.HapticFeedback.impactOccurred('medium');
            }, 1000);
        }

        function openModal(item) {
            selectedItem = item;
            document.getElementById('modal-img').innerText = item.icon;
            document.getElementById('modal-name').innerText = item.name;
            document.getElementById('modal-price').innerText = item.price + " ‚Ç¥";
            document.getElementById('itemModal').classList.add('active');
        }

        function closeModal() {
            document.getElementById('itemModal').classList.remove('active');
        }

        function addToCartFromModal() {
            cart.push(selectedItem);
            total += selectedItem.price;
            document.getElementById('footer').style.display = 'block';
            document.getElementById('total').innerText = total + ' ‚Ç¥';
            closeModal();
            tg.HapticFeedback.notificationOccurred('success');
        }

        function sendOrder() {
            let msg = "üöÄ –ó–ê–ú–û–í–õ–ï–ù–ù–Ø –ó –ì–õ–û–ë–ê–õ–¨–ù–û–ì–û –ü–û–®–£–ö–£:%0A";
            cart.forEach(i => msg += `- ${i.name} (${i.price} ‚Ç¥)%0A`);
            msg += `%0A–†–ê–ó–û–ú: ${total} ‚Ç¥`;
            window.open(`https://t.me/–¢–í–Ü–ô_–õ–û–ì–Ü–ù?text=${msg}`);
        }
    </script>
</body>
</html>
