<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>3D Smart Hub</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { background-color: #f3f4f6; font-family: -apple-system, sans-serif; }
        .item-card { background: white; border-radius: 20px; padding: 16px; transition: all 0.2s ease; border: 1px solid transparent; }
        .item-card:active { transform: scale(0.95); background: #fefce8; border-color: #f4b324; }
        .search-bar { background: #18181b; border-radius: 18px; padding: 16px; margin: 16px; box-shadow: 0 10px 25px rgba(0,0,0,0.15); }
        .add-btn { background: #f4b324; color: white; border-radius: 12px; width: 100%; padding: 10px; font-weight: 800; font-size: 12px; margin-top: 12px; }
        .empty-state { text-align: center; padding: 40px; color: #9ca3af; }
    </style>
</head>
<body class="pb-32">

    <div class="search-bar">
        <div class="flex items-center justify-between mb-3">
            <span id="status-tag" class="text-[9px] font-black uppercase tracking-widest text-zinc-500">Live Database Access</span>
            <div id="loading-spinner" class="hidden w-3 h-3 border-2 border-yellow-500 border-t-transparent rounded-full animate-spin"></div>
        </div>
        <input id="autoSearch" type="text" oninput="doLiveSearch()" placeholder="–ü–æ—á–Ω—ñ—Ç—å –ø–∏—Å–∞—Ç–∏ (–Ω–∞–ø—Ä. —à–æ–ª–æ–º...)" 
            class="w-full bg-zinc-800 border-none rounded-xl p-4 text-white outline-none focus:ring-2 focus:ring-yellow-500 transition-all">
    </div>

    <div class="px-4">
        <h2 id="list-title" class="text-[10px] font-bold text-zinc-400 uppercase tracking-widest mb-4 ml-2">–í—Å—ñ –º–æ–¥–µ–ª—ñ</h2>
        <div id="catalog-grid" class="grid grid-cols-2 gap-4">
            </div>
        <div id="empty-msg" class="empty-state hidden">
            <div class="text-4xl mb-2">üîç</div>
            <p class="text-sm font-bold">–ù—ñ—á–æ–≥–æ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ...</p>
            <button onclick="requestCustom()" class="mt-4 text-yellow-600 font-bold underline">–ó–∞–º–æ–≤–∏—Ç–∏ —ñ–Ω–¥–∏–≤—ñ–¥—É–∞–ª—å–Ω–æ?</button>
        </div>
    </div>

    <div id="footer-btn" class="fixed bottom-0 left-0 right-0 p-6 bg-white/80 backdrop-blur-xl border-t hidden z-50 animate-in fade-in slide-in-from-bottom-5">
        <button onclick="sendOrder()" class="w-full bg-[#f4b324] text-white py-4 rounded-2xl font-black text-sm uppercase tracking-tighter shadow-xl flex justify-between px-8">
            <span>–û–§–û–†–ú–ò–¢–ò –ó–ê–ú–û–í–õ–ï–ù–ù–Ø</span>
            <span id="total-price" class="bg-black/20 px-2 rounded">0 ‚Ç¥</span>
        </button>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        let cart = [];
        let total = 0;

        // –ë–∞–∑–∞ –¥–∞–Ω–∏—Ö
        const models = [
            { name: "Iron Man Helmet", price: 2500, icon: "‚õëÔ∏è", tags: "—à–æ–ª–æ–º –º–∞—Å–∫–∞ –∑–∞–ª—ñ–∑–Ω–∞ –ª—é–¥–∏–Ω–∞" },
            { name: "Flexi Dragon", price: 450, icon: "üêâ", tags: ["–¥—Ä–∞–∫–æ–Ω", "—ñ–≥—Ä–∞—à–∫–∞", "—Ñ–ª–µ–∫—Å—ñ"] },
            { name: "Phone Stand", price: 120, icon: "üì±", tags: "–ø—ñ–¥—Å—Ç–∞–≤–∫–∞ —Ç–µ–ª–µ—Ñ–æ–Ω —Ö–æ–ª–¥–µ—Ä" },
            { name: "Geometric Vase", price: 300, icon: "üè∫", tags: "–≤–∞–∑–∞ –¥–µ–∫–æ—Ä —ñ–Ω—Ç–µ—Ä'—î—Ä" },
            { name: "Mandalorian", price: 2100, icon: "üé≠", tags: "—à–æ–ª–æ–º –º–∞–Ω–¥–∞–ª–æ—Ä–µ—Ü—å –∑–æ—Ä—è–Ω—ñ –≤—ñ–π–Ω–∏" },
            { name: "Gear Set", price: 180, icon: "‚öôÔ∏è", tags: "—à–µ—Å—Ç–µ—Ä–Ω—è –¥–µ—Ç–∞–ª—å –º–µ—Ö–∞–Ω—ñ–∑–º" },
            { name: "Pot for Flowers", price: 220, icon: "ü™¥", tags: "–≥–æ—Ä—â–∏–∫ –≤–∞–∑–æ–Ω –∫–≤—ñ—Ç–∏" },
            { name: "Skull Lamp", price: 850, icon: "üíÄ", tags: "—á–µ—Ä–µ–ø –ª–∞–º–ø–∞ —Å–≤—ñ—Ç–ª–æ" }
        ];

        // –ü–µ—Ä—à–∏–π –∑–∞–ø—É—Å–∫ - –ø–æ–∫–∞–∑—É—î–º–æ –≤—Å–µ
        window.onload = () => renderItems(models);

        function renderItems(items) {
            const grid = document.getElementById('catalog-grid');
            const emptyMsg = document.getElementById('empty-msg');
            grid.innerHTML = '';

            if (items.length === 0) {
                emptyMsg.classList.remove('hidden');
                return;
            }

            emptyMsg.classList.add('hidden');
            items.forEach(item => {
                grid.innerHTML += `
                    <div class="item-card shadow-sm animate-in fade-in zoom-in duration-300">
                        <div class="text-5xl mb-3">${item.icon}</div>
                        <h3 class="text-[11px] font-black uppercase truncate text-zinc-800">${item.name}</h3>
                        <p class="text-yellow-500 font-bold text-sm mt-1">${item.price} ‚Ç¥</p>
                        <button onclick="addToCart('${item.name}', ${item.price})" class="add-btn uppercase tracking-tighter">–í –∫–æ—à–∏–∫</button>
                    </div>
                `;
            });
        }

        function doLiveSearch() {
            const query = document.getElementById('autoSearch').value.toLowerCase().trim();
            const title = document.getElementById('list-title');
            const spinner = document.getElementById('loading-spinner');

            spinner.classList.remove('hidden');

            // –Ü–º—ñ—Ç–∞—Ü—ñ—è –º–∏—Ç—Ç—î–≤–æ—ó –∑–∞—Ç—Ä–∏–º–∫–∏ –¥–ª—è –ø–ª–∞–≤–Ω–æ—Å—Ç—ñ
            setTimeout(() => {
                const filtered = models.filter(m => 
                    m.name.toLowerCase().includes(query) || 
                    m.tags.toString().toLowerCase().includes(query)
                );

                title.innerText = query ? `–†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –∑–∞ –∑–∞–ø–∏—Ç–æ–º: ${query}` : "–í—Å—ñ –º–æ–¥–µ–ª—ñ";
                renderItems(filtered);
                spinner.classList.add('hidden');
            }, 150);
        }

        function addToCart(name, price) {
            cart.push({name, price});
            total += price;
            tg.HapticFeedback.impactOccurred('medium');
            document.getElementById('footer-btn').style.display = 'block';
            document.getElementById('total-price').innerText = total + ' ‚Ç¥';
        }

        function requestCustom() {
            const query = document.getElementById('autoSearch').value;
            window.open(`https://t.me/–¢–í–Ü–ô_–õ–û–ì–Ü–ù?text=–•–æ—á—É –∑–∞–º–æ–≤–∏—Ç–∏ —ñ–Ω–¥–∏–≤—ñ–¥—É–∞–ª—å–Ω—É –º–æ–¥–µ–ª—å: ${query}`);
        }

        function sendOrder() {
            let msg = "üõí –ù–û–í–ï –ó–ê–ú–û–í–õ–ï–ù–ù–Ø:%0A";
            cart.forEach(i => msg += `- ${i.name} (${i.price} ‚Ç¥)%0A`);
            msg += `%0A–†–ê–ó–û–ú: ${total} ‚Ç¥`;
            window.open(`https://t.me/–¢–í–Ü–ô_–õ–û–ì–Ü–ù?text=${msg}`);
        }
    </script>
</body>
</html>
